# TODO

- [x] ~~Should the .xcode* files be committed into git? isn't that the point of using tuist - to not require checking them in?~~
  - **RESOLVED**: Updated .gitignore to exclude .xcodeproj/.xcworkspace files (generated by Tuist)
  - Removed existing files from git tracking with `git rm --cached`
  - Fixed Package.resolved to be committed for reproducible builds

- [x] ~~Should we add a troubleshooting note in CLAUDE.md/README.md about tuist cache corruption and clearing that?~~
  - **COMPLETED**: Added comprehensive "Tuist Cache Corruption" section to CLAUDE.md
  - Includes progressive 4-level troubleshooting approach
  - Enhanced debugging commands section

- [x] ~~add a note about closure issues to `CLAUDE.md`~~
  - **COMPLETED**: Added "Closure Capture Patterns" section to TCA conventions
  - Includes problem/solution patterns with clear examples
  - Critical guidance for preventing Swift closure capture errors

- [x] ~~Pre-commit hooks (to ensure we trigger tests + lint + format + build + ...?)~~
  - **COMPLETED**: Implemented comprehensive pre-commit hooks using pre-commit framework
  - Hooks validate: SwiftFormat, SwiftLint, build success, tests passing, file safety
  - Added `make setup-hooks` command for easy team onboarding
  - Updated CLAUDE.md with detailed setup and troubleshooting instructions
  - Rejected Husky in favor of pre-commit framework (better for Swift/iOS ecosystem)

- [x] ~~Implement complete CI testing with act~~
  - **COMPLETED**: Discovered act's self-hosted mode for native macOS execution
  - Created `.actrc` configuration for iOS development with `-P macos-15=-self-hosted`
  - Added Makefile targets: `validate-ci-act`, `validate-ci-jobs`, `validate-ci-dry`
  - Updated CLAUDE.md with comprehensive act + self-hosted documentation
  - Successfully tested workflow structure validation with native Xcode access
  - Provides complete local CI simulation without Docker limitations

- [ ] Instructions for setup/install of suggested MCP servers (exa + zen + context7 + xcodebuilmcp) + sample JSON of mcp config

## CI/CD Critical Issues

- [ ] **CRITICAL: GitHub Actions CI has never worked despite extensive debugging**
  - **Environment**: GitHub Actions macos-15, Xcode 16.4, Tuist 4.61.1
  - **Project**: TMA architecture with ComposableArchitecture, Perception, Dependencies, CasePaths
  - **Core Issue**: Swift Macros "Multiple commands produce" conflicts
  
  **Errors Encountered**:
  - `error: Multiple commands produce '.../ComposableArchitectureMacros'`
  - `error: Multiple commands produce '.../PerceptionMacros'` 
  - `error: Multiple commands produce '.../DependenciesMacrosPlugin'`
  - `error: Multiple commands produce '.../CasePathsMacros'`
  
  **Root Cause**: Multiple Swift Packages with macros trying to copy executables to same `$BUILT_PRODUCT_DIR`
  
  **Solutions Attempted (ALL FAILED)**:
  - iOS version targeting: 17.0 → 18.0 → 18.4 → removed entirely
  - Destination specification: UUID-based, name-based, automatic selection
  - TCA version downgrade: 1.21.1 → 1.16.1 (matches Tuist working example)
  - Swift Macros skip flags: `-skipPackagePluginValidation -skipMacroValidation`
  - Xcode defaults: `IDESkipMacroFingerprintValidation`, `IDESkipPackagePluginFingerprintValidation`
  - PackageSettings: Copied exact configuration from Tuist's working example
  - Build tools: xcodebuild vs tuist commands
  
  **Key Findings**:
  - Tuist's own working example (TCA 1.16.1) fails with same macro conflicts
  - Issue persists even with Tuist's exact CI configuration and package settings
  - Problem appears to be fundamental incompatibility between TCA ecosystem macros and Tuist project generation
  - Related GitHub issues: tuist/tuist#7570, tuist/tuist#7164 (still open)
  
  **Status**: **UNRESOLVED** - CI has never succeeded in any configuration
  
  **Recommendations**:
  - Consider alternative architecture without TCA macro dependencies
  - File minimal reproduction case with Tuist team
  - Investigate pure Xcode project approach vs Tuist-generated projects
  - Wait for Tuist team to resolve Swift Macros conflicts in future releases

## Code Signing & Device Installation

- [ ] **Add proper code signing configuration for device builds**
  - Replace `"YOUR_TEAM_ID_HERE"` placeholder in Project.swift with environment variable approach
  - Configure automatic code signing with development team ID
  - Enable `tuist share --platforms ios` for device installation support
  - Test device installation workflow end-to-end

## Testing & Validation

- [ ] **Validate `tuist share` workflow**
  - Test simulator builds with `tuist share` (currently working)
  - Test device builds after code signing is configured
  - Verify preview links work for both simulator and device installation
  - Document troubleshooting steps for common signing issues

## Localization & Internationalization

- [ ] **Implement proper localization infrastructure**
  - Replace `LocalizedStrings` static strings with actual `NSLocalizedString` calls
  - Create `.strings` files for supported languages (starting with English base)
  - Add proper locale handling in `String.formatted` helper method
  - Consider renaming `LocalizedStrings` to `StaticStrings` until full i18n is implemented
  - Add localization TODO comments where strings should be translated
  - Test localization workflow with pseudo-localization or test language
